<%- include("../../partials/header", { title }) %>

<div class="d-flex align-items-center justify-content-between mb-3">
  <h1 class="h3 mb-0">Inventory Locations</h1>
  <a class="btn btn-primary" href="/admin/kost/inventory/locations/new">+ New Location</a>
</div>

<div class="card">
  <div class="table-responsive">
    <table class="table table-striped table-hover mb-0 align-middle">
      <thead>
        <tr>
          <th style="width:80px;">ID</th>
          <th>Name</th>
          <th style="width:120px;">Active</th>
          <th style="width:120px;">Type</th>
          <th style="width:120px;">Room</th>
          <th style="width:220px;">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% if (!locations || locations.length === 0) { %>
          <tr>
            <td colspan="4" class="text-center text-muted py-4">
              Belum ada lokasi. Buat lokasi pertama (contoh: <b>Gudang Utama</b>).
            </td>
          </tr>
        <% } %>

        <% locations.forEach((l) => { %>
          <tr>
            <td class="mono"><%= l.id %></td>
            <td><%= l.name %></td>
            <td>
              <% if (l.is_active) { %>
                <span class="badge bg-success">Active</span>
              <% } else { %>
                <span class="badge bg-secondary">Disabled</span>
              <% } %>
            </td>
            <td><%= l.location_type %></td>
            <td><%= l.room_id ? l.room_id : "-" %></td>

            <td>
            <a class="btn btn-sm btn-outline-primary" href="/admin/kost/inventory/locations/<%= l.id %>/edit">Edit</a>

            <% if (l.is_active) { %>
                <form method="POST" action="/admin/kost/inventory/locations/<%= l.id %>/delete" class="d-inline"
                onsubmit="return confirm('Disable lokasi ini?');">
                <button class="btn btn-sm btn-outline-danger" type="submit">
                    Disable
                </button>
                </form>
            <% } else { %>
                <form method="POST" action="/admin/kost/inventory/locations/<%= l.id %>" class="d-inline"
                onsubmit="return confirm('Enable lokasi ini?');">
                <!-- kirim field lengkap untuk update -->
                <input type="hidden" name="location_type" value="<%= l.location_type %>">
                <input type="hidden" name="room_id" value="<%= l.room_id ?? "" %>">
                <input type="hidden" name="name" value="<%= l.name %>">
                <input type="hidden" name="is_active" value="1">

                <button class="btn btn-sm btn-outline-success" type="submit">
                    Enable
                </button>
                </form>
            <% } %>
            </td>

          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<%- include("../../partials/footer") %>
